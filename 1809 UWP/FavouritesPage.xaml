<Page
    x:Class="_1809_UWP.FavouritesPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:_1809_UWP"
    Background="Transparent">

    <Page.Resources>
        <AcrylicBrush x:Key="TransparentAcrylic"
                      BackgroundSource="Backdrop"
                      TintColor="{ThemeResource SystemAltHighColor}"
                      TintOpacity="0.4"
                      FallbackColor="{ThemeResource SystemAltHighColor}"/>

        <Storyboard x:Name="FadeInAnimation">
            <DoubleAnimation
                Storyboard.TargetName="LoadingOverlay"
                Storyboard.TargetProperty="Opacity"
                From="0" To="1" Duration="0:0:0.250"
                EnableDependentAnimation="True"/>
        </Storyboard>
        <Storyboard x:Name="FadeOutAnimation">
            <DoubleAnimation
                Storyboard.TargetName="LoadingOverlay"
                Storyboard.TargetProperty="Opacity"
                From="1" To="0" Duration="0:0:0.350"
                EnableDependentAnimation="True"/>
        </Storyboard>
    </Page.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock Text="Favourites" Style="{ThemeResource TitleTextBlockStyle}" Margin="24,12"/>

        <GridView x:Name="FavouritesGridView"
                  Grid.Row="1"
                  Padding="24,0,24,24"
                  IsItemClickEnabled="False"
                  SelectionMode="Multiple"
                  SelectionChanged="FavouritesGridView_SelectionChanged"
                  HorizontalAlignment="Center">

            <GridView.ItemContainerStyle>
                <Style TargetType="GridViewItem">
                    <Setter Property="Margin" Value="8"/>
                </Style>
            </GridView.ItemContainerStyle>

            <GridView.ItemTemplate>
                <DataTemplate x:DataType="local:FavouriteItem">
                    <Grid Width="280" 
                          MinHeight="200"
                          BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                          BorderThickness="1"
                          Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                          CornerRadius="{ThemeResource ControlCornerRadius}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <Rectangle Grid.Row="0">
                            <Rectangle.Fill>
                                <ImageBrush ImageSource="{x:Bind ImageUrl, Mode=OneWay, Converter={StaticResource GlobalUrlToImageConverter}}" Stretch="UniformToFill"/>
                            </Rectangle.Fill>
                        </Rectangle>
                        
                        <StackPanel Grid.Row="1" Padding="12" Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}">
                            <TextBlock Text="{x:Bind DisplayTitle}" 
                                       Style="{ThemeResource SubtitleTextBlockStyle}" 
                                       TextWrapping="Wrap"/>

                            <Grid Margin="0,8,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Button Grid.Column="0"
                                        Content="Article" 
                                        Click="ArticleButton_Click" 
                                        Tag="{x:Bind}"
                                        Visibility="{x:Bind IsArticleAvailable, Converter={StaticResource GlobalBoolToVisibility}}"/>

                                <Button Grid.Column="1"
                                        Content="Talk" 
                                        Margin="8,0,0,0"
                                        Click="TalkButton_Click"
                                        Tag="{x:Bind}"
                                        Visibility="{x:Bind IsTalkAvailable, Converter={StaticResource GlobalBoolToVisibility}}"/>
                            </Grid>
                        </StackPanel>
                    </Grid>
                </DataTemplate>
            </GridView.ItemTemplate>
        </GridView>

        <TextBlock x:Name="NoFavouritesTextBlock"
                   Text="You haven't added any Favourites yet."
                   Grid.Row="1"
                   Style="{ThemeResource SubtitleTextBlockStyle}"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"
                   Visibility="Collapsed"/>

        <CommandBar x:Name="BottomCommandBar"
                    Grid.Row="2"
                    Visibility="Collapsed">
            <AppBarButton x:Name="DeleteButton" 
                          Icon="Delete" 
                          Label="Delete" 
                          Click="DeleteButton_Click"/>
        </CommandBar>

        <Grid x:Name="LoadingOverlay" 
              Opacity="0" 
              IsHitTestVisible="False" 
              Grid.RowSpan="3"
              Background="{StaticResource TransparentAcrylic}">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="12">
                <ProgressRing IsActive="True" Width="60" Height="60"/>
            </StackPanel>
        </Grid>
    </Grid>
</Page>